{"version":3,"file":"react-stubby.js","sources":["../src/constant.js","../src/AddOn.js","../src/StubConsumer.js","../src/StubProvider.js","../src/Stub.js","../src/index.js"],"sourcesContent":["export const DEFAULT_STUB_NAME = '$$default'\n\nexport const ADD_ON_DN = 'Stub.AddOn'\n\nexport const ADD_ON_HOC_DN = `StubConsumer(${ADD_ON_DN})`\n","import PropTypes from 'prop-types'\nimport {\n  DEFAULT_STUB_NAME,\n  ADD_ON_DN\n} from './constant'\n\nconst AddOn = () => null\n\nAddOn.propTypes = { name: PropTypes.string }\nAddOn.defaultTypes = { name: DEFAULT_STUB_NAME }\nAddOn.displayName = ADD_ON_DN\n\nexport default AddOn\n","import React from 'react'\nimport AddOn from './AddOn'\n\nimport {\n  ADD_ON_HOC_DN\n} from './constant'\n\nexport default (stub) => (WrappedComponent) => {\n  const wrapper = (props) => (\n    <AddOn stub={stub}>\n      <WrappedComponent {...props} />\n    </AddOn>\n  )\n\n  wrapper.displayName = ADD_ON_HOC_DN\n\n  return wrapper\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport {\n  DEFAULT_STUB_NAME,\n  ADD_ON_DN,\n  ADD_ON_HOC_DN\n} from './constant'\n\nfunction getDisplayName (component) {\n  return component.displayName || component.name || 'component'\n}\n\nexport default (WrappedComponent) => {\n  return class StubWrapper extends React.Component {\n    static displayName = `StubProvider(${getDisplayName(WrappedComponent)})`\n\n    static childContextTypes = {\n      requestAddOnRenderer: PropTypes.func\n    }\n\n    addOnRenderers = {}\n\n    getChildContext () {\n      return {\n        requestAddOnRenderer: this.addOnRendererRegister.bind(this)\n      }\n    }\n\n    addOnRendererRegister (name) {\n      return () => {\n        return this.addOnRenderers[name]\n      }\n    }\n\n    render () {\n      const {\n        children,\n        ...restProps\n      } = this.props\n\n      if (children) {\n        const arr = React.Children.toArray(children)\n        const nameChecked = []\n        this.addOnRenderers = {}\n        arr.forEach(item => {\n          const itemType = item.type\n          if (itemType.displayName === ADD_ON_HOC_DN) {\n            item = itemType(children.props)\n          }\n          if (item.type.displayName === ADD_ON_DN) {\n            const stubName = item.props.stub || DEFAULT_STUB_NAME\n            // checking, ensure the uniqueness of the consumer\n            if (nameChecked.findIndex(item => item === stubName) !== -1) {\n              throw new Error(`Stub(${stubName}) has been occupied`)\n            }\n\n            this.addOnRenderers[stubName] = item.props.children\n            // cache for next checking\n            nameChecked.push(stubName)\n          }\n        })\n      }\n      return (<WrappedComponent {...restProps} />)\n    }\n  }\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport {\n  DEFAULT_STUB_NAME\n} from './constant'\n\nexport default class Stub extends React.Component {\n  static contextTypes = {\n    requestAddOnRenderer: PropTypes.func\n  }\n\n  static propTypes = {\n    name: PropTypes.string\n  }\n\n  static defaultProps = {\n    name: DEFAULT_STUB_NAME\n  }\n\n  constructor (props, context) {\n    super(props, context)\n    this.addOnRenderer = context.requestAddOnRenderer(props.name)\n  }\n\n  render () {\n    return (this.addOnRenderer && this.addOnRenderer()) ||\n      this.props.children ||\n      null\n  }\n}\n","import _StubConsumer from './StubConsumer'\nimport _StubProvider from './StubProvider'\nimport _AddOn from './AddOn'\nimport _Stub from './Stub'\n\nexport const StubConsumer = _StubConsumer\n\nexport const StubProvider = _StubProvider\n\n_Stub.AddOn = _AddOn\n\nexport const Stub = _Stub\n"],"names":["DEFAULT_STUB_NAME","ADD_ON_DN","ADD_ON_HOC_DN","AddOn","propTypes","name","PropTypes","string","defaultTypes","displayName","stub","WrappedComponent","wrapper","props","getDisplayName","component","addOnRenderers","addOnRendererRegister","bind","children","restProps","arr","React","Children","toArray","nameChecked","forEach","itemType","item","type","stubName","findIndex","Error","push","Component","childContextTypes","func","Stub","context","addOnRenderer","requestAddOnRenderer","contextTypes","defaultProps","StubConsumer","_StubConsumer","StubProvider","_StubProvider","_Stub","_AddOn"],"mappings":"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"}