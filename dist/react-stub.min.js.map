{"version":3,"file":"react-stub.min.js","sources":["../src/constant.js","../src/AddOn.js","../src/StubConsumer.js","../src/StubProvider.js","../src/Stub.js","../src/index.js"],"sourcesContent":["export const DEFAULT_STUB_NAME = '$$default'\n\nexport const ADD_ON_DN = 'Stub.AddOn'\n\nexport const ADD_ON_HOC_DN = `StubConsumer(${ADD_ON_DN})`\n","import PropTypes from 'prop-types'\nimport {\n  DEFAULT_STUB_NAME,\n  ADD_ON_DN\n} from './constant'\n\nconst AddOn = () => null\n\nAddOn.propTypes = { name: PropTypes.string }\nAddOn.defaultTypes = { name: DEFAULT_STUB_NAME }\nAddOn.displayName = ADD_ON_DN\n\nexport default AddOn\n","import React from 'react'\nimport AddOn from './AddOn'\n\nimport {\n  ADD_ON_HOC_DN\n} from './constant'\n\nexport default (stub) => (WrappedComponent) => {\n  const wrapper = (props) => (\n    <AddOn stub={stub}>\n      <WrappedComponent {...props} />\n    </AddOn>\n  )\n\n  wrapper.displayName = ADD_ON_HOC_DN\n\n  return wrapper\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport {\n  DEFAULT_STUB_NAME,\n  ADD_ON_DN,\n  ADD_ON_HOC_DN\n} from './constant'\n\nfunction getDisplayName (component) {\n  return component.displayName || component.name || 'component'\n}\n\nexport default (WrappedComponent) => {\n  return class StubWrapper extends React.Component {\n    static displayName = `StubProvider(${getDisplayName(WrappedComponent)})`\n\n    static childContextTypes = {\n      requestAddOnRenderer: PropTypes.func\n    }\n\n    addOnRenderers = {}\n\n    getChildContext () {\n      return {\n        requestAddOnRenderer: this.addOnRendererRegister.bind(this)\n      }\n    }\n\n    addOnRendererRegister (name) {\n      return () => {\n        return this.addOnRenderers[name]\n      }\n    }\n\n    render () {\n      const {\n        children,\n        ...restProps\n      } = this.props\n\n      if (children) {\n        const arr = React.Children.toArray(children)\n        const nameChecked = []\n        this.addOnRenderers = {}\n        arr.forEach(item => {\n          const itemType = item.type\n          if (itemType.displayName === ADD_ON_HOC_DN) {\n            item = itemType(children.props)\n          }\n          if (item.type.displayName === ADD_ON_DN) {\n            const stubName = item.props.stub || DEFAULT_STUB_NAME\n            // checking, ensure the uniqueness of the consumer\n            if (nameChecked.findIndex(item => item === stubName) !== -1) {\n              throw new Error(`Stub(${stubName}) has been occupied`)\n            }\n\n            this.addOnRenderers[stubName] = item.props.children\n            // cache for next checking\n            nameChecked.push(stubName)\n          }\n        })\n      }\n      return (<WrappedComponent {...restProps} />)\n    }\n  }\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport {\n  DEFAULT_STUB_NAME\n} from './constant'\n\nexport default class Stub extends React.Component {\n  static contextTypes = {\n    requestAddOnRenderer: PropTypes.func\n  }\n\n  static propTypes = {\n    name: PropTypes.string\n  }\n\n  static defaultProps = {\n    name: DEFAULT_STUB_NAME\n  }\n\n  constructor (props, context) {\n    super(props, context)\n    this.addOnRenderer = context.requestAddOnRenderer(props.name)\n  }\n\n  render () {\n    return (this.addOnRenderer && this.addOnRenderer()) ||\n      this.props.children ||\n      null\n  }\n}\n","import _StubConsumer from './StubConsumer'\nimport _StubProvider from './StubProvider'\nimport _AddOn from './AddOn'\nimport _Stub from './Stub'\n\nexport const StubConsumer = _StubConsumer\n\nexport const StubProvider = _StubProvider\n\n_Stub.AddOn = _AddOn\n\nexport const Stub = _Stub\n"],"names":["AddOn","propTypes","name","PropTypes","string","defaultTypes","displayName","Stub","props","context","addOnRenderer","requestAddOnRenderer","this","children","React","Component","contextTypes","func","defaultProps","StubConsumer","stub","WrappedComponent","wrapper","StubProvider","component","addOnRenderers","addOnRendererRegister","bind","_this2","restProps","arr","Children","toArray","nameChecked","forEach","itemType","item","type","stubName","findIndex","Error","push","childContextTypes","_Stub","_AddOn"],"mappings":"4WAAO,ICMDA,EAAQ,kBAAM,MAEpBA,EAAMC,WAAcC,KAAMC,EAAUC,QACpCJ,EAAMK,cAAiBH,KDTU,aCUjCF,EAAMM,YDRmB,aEKzB,wzBCKA,ICNqBC,yBAaNC,EAAOC,4EACZD,EAAOC,aACRC,cAAgBD,EAAQE,qBAAqBH,EAAMN,iEAIhDU,KAAKF,eAAiBE,KAAKF,iBACjCE,KAAKJ,MAAMK,UACX,YArB4BC,EAAMC,WAAnBR,EACZS,mCACiBb,EAAUc,MAFfV,EAKZN,gBACCE,EAAUC,QANCG,EASZW,mBJfwB,aKK1B,IAAMC,WHEGC,UAAS,SAACC,OAClBC,EAAU,SAACd,UACfM,mBAAOM,KAAMA,mBACVC,EAAqBb,cAIlBF,uCAEDgB,IGTIC,WFKGF,WAJSG,4NAYrBC,gHAI0Bb,KAAKc,sBAAsBC,KAAKf,qDAInCV,qBACd,kBACE0B,EAAKH,eAAevB,kDAQzBU,KAAKJ,MAFPK,IAAAA,SACGgB,6IAGDhB,EAAU,KACNiB,EAAMhB,EAAMiB,SAASC,QAAQnB,GAC7BoB,UACDR,oBACDS,QAAQ,gBACJC,EAAWC,EAAKC,qCAClBF,EAAS7B,gBACJ6B,EAAStB,EAASL,QH7CZ,eG+CX4B,EAAKC,KAAK/B,YAA2B,KACjCgC,EAAWF,EAAK5B,MAAMY,MHlDP,gBGoDqC,IAAtDa,EAAYM,UAAU,mBAAQH,IAASE,UACnC,IAAIE,cAAcF,2BAGrBb,eAAea,GAAYF,EAAK5B,MAAMK,WAE/B4B,KAAKH,aAIfxB,gBAACO,EAAqBQ,UAjDDf,EAAMC,aAC9BT,8BANckB,EAM+BH,GALrCf,aAAekB,EAAUtB,MAAQ,mBAOzCwC,wCACiBvC,EAAUc,SERtC0B,EAAM3C,MAAQ4C,EAEd,IAAarC,EAAOoC"}